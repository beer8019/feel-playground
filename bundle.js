var app=function(){"use strict";function t(){}function e(t){return t()}function r(){return Object.create(null)}function n(t){t.forEach(e)}function i(t){return"function"==typeof t}function o(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function s(t,e){t.appendChild(e)}function a(t,e,r){t.insertBefore(e,r||null)}function u(t){t.parentNode.removeChild(t)}function f(t){return document.createElement(t)}function h(t){return document.createTextNode(t)}function c(){return h(" ")}function l(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function p(t,e,r){null==r?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function d(t,e){e=""+e,t.data!==e&&(t.data=e)}function v(t,e){(null!=e||t.value)&&(t.value=e)}function g(t,e,r,n){t.style.setProperty(e,r,n?"important":"")}function y(t,e){for(let r=0;r<t.options.length;r+=1){const n=t.options[r];if(n.__value===e)return void(n.selected=!0)}}function b(t,e,r){t.classList[r?"add":"remove"](e)}let m;function x(t){m=t}function k(){if(!m)throw new Error("Function called outside component initialization");return m}Element.prototype.scrollIntoViewIfNeeded||(Element.prototype.scrollIntoViewIfNeeded=function(t){function e(t,e){return{start:t,length:e,end:t+e}}function r(e,r){return!1===t||r.start<e.end&&e.start<r.end?Math.max(e.end-r.length,Math.min(r.start,e.start)):(e.start+e.end-r.length)/2}function n(t,e){return{x:t,y:e,translate:function(r,i){return n(t+r,e+i)}}}function i(t,e){for(;t;)e=e.translate(t.offsetLeft,t.offsetTop),t=t.offsetParent;return e}for(var o,s=i(this,n(0,0)),a=n(this.offsetWidth,this.offsetHeight),u=this.parentNode;u instanceof HTMLElement;)o=i(u,n(u.clientLeft,u.clientTop)),u.scrollLeft=r(e(s.x-o.x,a.x),e(u.scrollLeft,u.clientWidth)),u.scrollTop=r(e(s.y-o.y,a.y),e(u.scrollTop,u.clientHeight)),s=s.translate(-u.scrollLeft,-u.scrollTop),u=u.parentNode});const w=[],T=[],S=[],N=[],P=Promise.resolve();let O=!1;function $(t){S.push(t)}function z(){const t=new Set;do{for(;w.length;){const t=w.shift();x(t),j(t.$$)}for(;T.length;)T.pop()();for(let e=0;e<S.length;e+=1){const r=S[e];t.has(r)||(r(),t.add(r))}S.length=0}while(w.length);for(;N.length;)N.pop()();O=!1}function j(t){if(null!==t.fragment){t.update(),n(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach($)}}const A=new Set;let _;function C(){_={r:0,c:[],p:_}}function B(){_.r||n(_.c),_=_.p}function I(t,e){t&&t.i&&(A.delete(t),t.i(e))}function R(t,e,r,n){if(t&&t.o){if(A.has(t))return;A.add(t),_.c.push(()=>{A.delete(t),n&&(r&&t.d(1),n())}),t.o(e)}}function E(t){t&&t.c()}function L(t,r,o){const{fragment:s,on_mount:a,on_destroy:u,after_update:f}=t.$$;s&&s.m(r,o),$(()=>{const r=a.map(e).filter(i);u?u.push(...r):n(r),t.$$.on_mount=[]}),f.forEach($)}function F(t,e){const r=t.$$;null!==r.fragment&&(n(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function M(t,e){-1===t.$$.dirty[0]&&(w.push(t),O||(O=!0,P.then(z)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function D(e,i,o,s,a,u,f=[-1]){const h=m;x(e);const c=i.props||{},l=e.$$={fragment:null,ctx:null,props:u,update:t,not_equal:a,bound:r(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(h?h.$$.context:[]),callbacks:r(),dirty:f};let p=!1;l.ctx=o?o(e,c,(t,r,n=r)=>(l.ctx&&a(l.ctx[t],l.ctx[t]=n)&&(l.bound[t]&&l.bound[t](n),p&&M(e,t)),r)):[],l.update(),p=!0,n(l.before_update),l.fragment=!!s&&s(l.ctx),i.target&&(i.hydrate?l.fragment&&l.fragment.l(function(t){return Array.from(t.childNodes)}(i.target)):l.fragment&&l.fragment.c(),i.intro&&I(e.$$.fragment),L(e,i.target,i.anchor),z()),x(h)}class G{$destroy(){F(this,1),this.$destroy=t}$on(t,e){const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(e),()=>{const t=r.indexOf(e);-1!==t&&r.splice(t,1)}}$set(){}}function U(t,e,r){const n=t.slice();return n[7]=e[r],n}function H(t){let e,r,n=t[0].children,i=[];for(let e=0;e<n.length;e+=1)i[e]=J(U(t,n,e));const o=t=>R(i[t],1,1,()=>{i[t]=null});return{c(){e=f("div");for(let t=0;t<i.length;t+=1)i[t].c();p(e,"class","children svelte-8r9yaj")},m(t,n){a(t,e,n);for(let t=0;t<i.length;t+=1)i[t].m(e,null);r=!0},p(t,r){if(7&r){let s;for(n=t[0].children,s=0;s<n.length;s+=1){const o=U(t,n,s);i[s]?(i[s].p(o,r),I(i[s],1)):(i[s]=J(o),i[s].c(),I(i[s],1),i[s].m(e,null))}for(C(),s=n.length;s<i.length;s+=1)o(s);B()}},i(t){if(!r){for(let t=0;t<n.length;t+=1)I(i[t]);r=!0}},o(t){i=i.filter(Boolean);for(let t=0;t<i.length;t+=1)R(i[t]);r=!1},d(t){t&&u(e),function(t,e){for(let r=0;r<t.length;r+=1)t[r]&&t[r].d(e)}(i,t)}}}function J(t){let e;const r=new q({props:{node:t[7],onSelect:t[1],selection:t[2]}});return{c(){E(r.$$.fragment)},m(t,n){L(r,t,n),e=!0},p(t,e){const n={};1&e&&(n.node=t[7]),2&e&&(n.onSelect=t[1]),4&e&&(n.selection=t[2]),r.$set(n)},i(t){e||(I(r.$$.fragment,t),e=!0)},o(t){R(r.$$.fragment,t),e=!1},d(t){F(r,t)}}}function W(t){let e,r,n,i,o,v,g,y,m,x,k,w,T=(t[0].error?"ERROR":t[0].name)+"",S=t[0].start+"",N=t[0].end+"",P=t[0].children.length&&H(t);return{c(){e=f("div"),r=f("div"),n=f("span"),i=h(T),o=h(" [ "),v=h(S),g=h(", "),y=h(N),m=h(" ]"),x=c(),P&&P.c(),p(n,"class","name svelte-8r9yaj"),b(n,"error",t[0].error),p(r,"class","description svelte-8r9yaj"),p(e,"class","node svelte-8r9yaj"),b(e,"selected",t[4]),w=l(e,"mouseover",t[5])},m(u,f){a(u,e,f),s(e,r),s(r,n),s(n,i),s(r,o),s(r,v),s(r,g),s(r,y),s(r,m),s(e,x),P&&P.m(e,null),t[6](e),k=!0},p(t,[r]){(!k||1&r)&&T!==(T=(t[0].error?"ERROR":t[0].name)+"")&&d(i,T),1&r&&b(n,"error",t[0].error),(!k||1&r)&&S!==(S=t[0].start+"")&&d(v,S),(!k||1&r)&&N!==(N=t[0].end+"")&&d(y,N),t[0].children.length?P?(P.p(t,r),I(P,1)):(P=H(t),P.c(),I(P,1),P.m(e,null)):P&&(C(),R(P,1,1,()=>{P=null}),B()),16&r&&b(e,"selected",t[4])},i(t){k||(I(P),k=!0)},o(t){R(P),k=!1},d(r){r&&u(e),P&&P.d(),t[6](null),w()}}}function V(t,e,r){let n,{node:i}=e,{onSelect:o}=e,{selection:s}=e;var a;let u;return a=()=>{u&&n.scrollIntoViewIfNeeded()},k().$$.after_update.push(a),t.$set=t=>{"node"in t&&r(0,i=t.node),"onSelect"in t&&r(1,o=t.onSelect),"selection"in t&&r(2,s=t.selection)},t.$$.update=()=>{5&t.$$.dirty&&r(4,u=i===s)},[i,o,s,n,u,function(t){t.stopPropagation(),o(i)},function(t){T[t?"unshift":"push"](()=>{r(3,n=t)})}]}class q extends G{constructor(t){super(),D(this,t,V,W,o,{node:0,onSelect:1,selection:2})}}function Q(t,e){var r,n,i,o;function s(){var s=Date.now(),u=o+e-s;if(u>0)return a(u);t.apply(i,n),r=o=n=i=void 0}function a(t){r=setTimeout(s,t)}return function(){o=Date.now();for(var t=arguments.length,s=new Array(t),u=0;u<t;u++)s[u]=arguments[u];n=s,i=this,r||a(e)}}var X="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Y(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function K(t,e){return t(e={exports:{}},e.exports),e.exports}var Z=K((function(t,e){var r,n=X&&X.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultBufferLength=1024;var i=function(){function t(t,e){this.enter=t,this.leave=e,this.result=void 0}return Object.defineProperty(t.prototype,"done",{get:function(){return void 0!==this.result},enumerable:!0,configurable:!0}),t.prototype.doEnter=function(t,e,r){var n=this.enter(t,e,r);return void 0===n||(!1!==n&&(this.result=n),!1)},t}(),o=0,s=function(){function t(t){var e=(void 0===t?{}:t).deserialize;this.id=o++,this.deserialize=e||function(){throw new Error("This node type doesn't define a deserialize function")}}return t.string=function(){return new t({deserialize:function(t){return t}})},t.number=function(){return new t({deserialize:Number})},t.flag=function(){return new t({deserialize:function(){return!0}})},t.prototype.set=function(t,e){return t[this.id]=e,t},t.prototype.add=function(t){return new a(this,"function"==typeof t?t:u.match(t))},t.error=t.flag(),t.skipped=t.flag(),t.delim=t.string(),t.top=t.flag(),t}();e.NodeProp=s;var a=function(t,e){this.prop=t,this.f=e};e.NodePropSource=a;var u=function(){function t(t,e,r){this.name=t,this.props=e,this.id=r}return t.prototype.prop=function(t){return this.props[t.id]},t.match=function(t){var e=Object.create(null);for(var r in t)for(var n=0,i=r.split(" ");n<i.length;n++){var o=i[n];e[o]=t[r]}return function(t){return e[t.name]}},t.none=new t("",Object.create(null),0),t}();e.NodeType=u;var f=function(){function t(t){this.types=t;for(var e=0;e<t.length;e++)if(t[e].id!=e)throw new RangeError("Node type ids should correspond to array positions when creating a node group")}return t.prototype.extend=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var n=[],i=0,o=this.types;i<o.length;i++){for(var s=o[i],a=null,f=0,h=e;f<h.length;f++){var c=h[f],l=c.f(s);if(void 0!==l){if(!a)for(var p in a=Object.create(null),s.props)a[p]=s.props[p];a[c.prop.id]=l}}n.push(a?new u(s.name,a,s.id):s)}return new t(n)},t}();e.NodeGroup=f;var h=function(){function t(){}return Object.defineProperty(t.prototype,"name",{get:function(){return this.type.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"depth",{get:function(){for(var t=0,e=this.parent;e;e=e.parent)t++;return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){for(var t=this;t.parent;)t=t.parent;return t},enumerable:!0,configurable:!0}),t.prototype.resolve=function(t,e){void 0===e&&(e=0);var r=this.resolveAt(t);if(0!=e)for(;;){var n=e<0?r.childBefore(t):r.childAfter(t);if(!n||(e<0?n.end:n.start)!=t)break;r=n}return r},Object.defineProperty(t.prototype,"firstChild",{get:function(){return this.childAfter(this.start-1)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lastChild",{get:function(){return this.childBefore(this.end+1)},enumerable:!0,configurable:!0}),t}();e.Subtree=h;var c=function(t){function r(e,r,n,i){var o=t.call(this)||this;return o.type=e,o.children=r,o.positions=n,o.length=i,o}return n(r,t),Object.defineProperty(r.prototype,"start",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"end",{get:function(){return this.length},enumerable:!0,configurable:!0}),r.prototype.toString=function(){var t=this.children.map((function(t){return t.toString()})).join();return this.name?(/\W/.test(this.name)&&!this.type.prop(s.error)?JSON.stringify(this.name):this.name)+(t.length?"("+t+")":""):t},r.prototype.partial=function(t,e,n,i,o){for(var s=0;s<this.children.length;s++){var a=this.positions[s];if(a>e)break;var u=this.children[s],f=a+u.length;f<t||(t<=a&&e>=f?(i.push(u),o.push(a+n)):u instanceof r&&u.partial(t-a,e-a,n+a,i,o))}},r.prototype.applyChanges=function(t){if(0==t.length)return this;var e=[],n=[];function i(t,e,r){var n=-1;return t.iterate({from:e,to:r<0?0:t.length,enter:function(){return n<0&&void 0},leave:function(t,i,o){n<0&&!t.prop(s.error)&&(n=r<0?Math.min(e,o-1):Math.max(e,i+1))}}),n>-1?n:r<0?0:t.length}for(var o=0,a=0,f=0;;a++){var h=a==t.length?null:t[a],c=h?i(this,h.fromA,-1):this.length;if(c>f&&this.partial(f,c,o,e,n),!h)break;f=i(this,h.toA,1),o+=h.toB-h.fromB-(h.toA-h.fromA)}return new r(u.none,e,n,this.length+o)},r.prototype.cut=function(t){if(t>=this.length)return this;for(var e=[],n=[],i=0;i<this.children.length;i++){var o=this.positions[i];if(o>=t)break;var s=this.children[i],a=o+s.length;e.push(a<=t?s:s.cut(t-o)),n.push(o)}return new r(this.type,e,n,t)},r.prototype.iterate=function(t){var e=t.from,r=void 0===e?this.start:e,n=t.to,o=void 0===n?this.end:n,s=t.enter,a=t.leave,u=new i(s,a);return this.iterInner(r,o,0,u),u.result},r.prototype.iterInner=function(t,e,r,n){if(!this.type.name||n.doEnter(this.type,r,r+this.length)){if(t<=e)for(var i=0;i<this.children.length&&!n.done;i++){var o=this.children[i],s=(a=this.positions[i]+r)+o.length;if(a>e)break;s<t||o.iterInner(t,e,a,n)}else for(i=this.children.length-1;i>=0&&!n.done;i--){var a;o=this.children[i];if((s=(a=this.positions[i]+r)+o.length)<e)break;a>t||o.iterInner(t,e,a,n)}n.leave&&this.type.name&&n.leave(this.type,r,r+this.length)}},r.prototype.resolveAt=function(t){if(l==this)for(var e=p;;){var r=e.parent;if(!r)break;if(e.start<t&&e.end>t)return e.resolve(t);e=r}return l=this,p=this.resolveInner(t,0,this)},r.prototype.childBefore=function(t){return this.findChild(t,-1,0,this)},r.prototype.childAfter=function(t){return this.findChild(t,1,0,this)},r.prototype.findChild=function(t,e,n,i){for(var o=0;o<this.children.length;o++){var s=this.positions[o]+n,a=-1;if(s>=t)if(e<0&&o>0)a=o-1;else{if(!(e>0))break;a=o}if(a<0&&(s+this.children[o].length>t||e<0&&o==this.children.length-1)&&(a=o),a>=0){var u=this.children[a],f=this.positions[a]+n;if(0==u.length&&f==t)continue;if(u instanceof r)return u.type.name?new v(u,f,i):u.findChild(t,e,f,i);var h=u.findIndex(t,e,f,0,u.buffer.length);if(h>-1)return new g(u,f,h,i)}}return null},r.prototype.resolveInner=function(t,e,r){var n=this.findChild(t,0,e,r);return n?n.resolveAt(t):r},r.prototype.append=function(t){if(t.children.length&&t.positions[0]<this.length)throw new Error("Can't append overlapping trees");return new r(this.type,this.children.concat(t.children),this.positions.concat(t.positions),t.length)},r.prototype.balance=function(t){return void 0===t&&(t=e.DefaultBufferLength),this.children.length<=b?this:x(this.type,u.none,this.children,this.positions,0,this.children.length,0,t,this.length)},r.build=function(t){return m(t)},r.empty=new r(u.none,[],[],0),r}(h);e.Tree=c,c.prototype.parent=null;var l=c.empty,p=c.empty,d=function(){function t(t,e,r,n){void 0===n&&(n=u.none),this.buffer=t,this.length=e,this.group=r,this.type=n}return t.prototype.toString=function(){for(var t=[],e=0;e<this.buffer.length;)e=this.childToString(e,t);return t.join(",")},t.prototype.childToString=function(t,e){var r=this.buffer[t],n=this.buffer[t+3],i=this.group.types[r],o=i.name;if(/\W/.test(o)&&!i.prop(s.error)&&(o=JSON.stringify(o)),n>(t+=4)){for(var a=[];t<n;)t=this.childToString(t,a);o+="("+a.join(",")+")"}return e.push(o),t},t.prototype.cut=function(e){for(var r=0;r<this.buffer.length&&this.buffer[r+1]<e;)r+=4;for(var n=new Uint16Array(r),i=0;i<r;i+=4)n[i]=this.buffer[i],n[i+1]=this.buffer[i+1],n[i+2]=Math.min(e,this.buffer[i+2]),n[i+3]=Math.min(this.buffer[i+3],r);return new t(n,Math.min(e,this.length),this.group)},t.prototype.iterate=function(t){var e=t.from,r=void 0===e?0:e,n=t.to,o=void 0===n?this.length:n,s=t.enter,a=t.leave,u=new i(s,a);return this.iterInner(r,o,0,u),u.result},t.prototype.iterInner=function(t,e,r,n){if(t<=e)for(var i=0;i<this.buffer.length;)i=this.iterChild(t,e,r,i,n);else this.iterRev(t,e,r,0,this.buffer.length,n)},t.prototype.iterChild=function(t,e,r,n,i){var o=this.group.types[this.buffer[n++]],s=this.buffer[n++]+r,a=this.buffer[n++]+r,u=this.buffer[n++];if(s>e)return this.buffer.length;if(a>=t&&i.doEnter(o,s,a)){for(;n<u&&!i.done;)n=this.iterChild(t,e,r,n,i);i.leave&&i.leave(o,s,a)}return u},t.prototype.parentNodesByEnd=function(t,e){for(var r=this,n=[],i=function(t){var e=r.buffer[t+3];if(e==t+4)return e;for(var o=t+4;o<e;)o=i(o);return n.push(t),e},o=t;o<e;)o=i(o);return n},t.prototype.iterRev=function(t,e,r,n,i,o){var s=this,a=this.parentNodesByEnd(n,i),u=-1,f=-1,h=function(){a.length>0?(u=a.pop(),f=s.buffer[u+3]):f=-1};h();t:for(var c=i;c>n&&!o.done;){for(;f==c;){var l=u,p=this.buffer[l],d=this.buffer[l+1]+r,v=this.buffer[l+2]+r;if(h(),d<=t&&v>=e&&!o.doEnter(this.group.types[p],d,v)){for(c=l;f>l;)h();continue t}}var g=this.buffer[--c],y=this.buffer[--c]+r,b=this.buffer[--c]+r,m=this.buffer[--c];b>t||y<e||(g!=c+4||o.doEnter(this.group.types[m],b,y))&&o.leave&&o.leave(this.group.types[m],b,y)}},t.prototype.findIndex=function(t,e,r,n,i){for(var o=-1,s=n,a=this.buffer;s<i;){var u=a[s+1]+r,f=a[s+2]+r,h=u==f&&u==t;if(u>=t){if(e>0&&!h)return s;break}if(f>t)return s;h||(o=s),s=a[s+3]}return e<0?o:-1},t}();e.TreeBuffer=d;var v=function(t){function e(e,r,n){var i=t.call(this)||this;return i.node=e,i.start=r,i.parent=n,i}return n(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.node.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.start+this.node.length},enumerable:!0,configurable:!0}),e.prototype.resolveAt=function(t){return t<=this.start||t>=this.end?this.parent.resolveAt(t):this.node.resolveInner(t,this.start,this)},e.prototype.childBefore=function(t){return this.node.findChild(t,-1,this.start,this)},e.prototype.childAfter=function(t){return this.node.findChild(t,1,this.start,this)},e.prototype.toString=function(){return this.node.toString()},e.prototype.iterate=function(t){var e=t.from,r=void 0===e?this.start:e,n=t.to,o=void 0===n?this.end:n,s=t.enter,a=t.leave,u=new i(s,a);return this.node.iterInner(r,o,this.start,u),u.result},e}(h),g=function(t){function e(e,r,n,i){var o=t.call(this)||this;return o.buffer=e,o.bufferStart=r,o.index=n,o.parent=i,o}return n(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return this.buffer.group.types[this.buffer.buffer[this.index]]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"start",{get:function(){return this.buffer.buffer[this.index+1]+this.bufferStart},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this.buffer.buffer[this.index+2]+this.bufferStart},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"endIndex",{get:function(){return this.buffer.buffer[this.index+3]},enumerable:!0,configurable:!0}),e.prototype.childBefore=function(t){var r=this.buffer.findIndex(t,-1,this.bufferStart,this.index+4,this.endIndex);return r<0?null:new e(this.buffer,this.bufferStart,r,this)},e.prototype.childAfter=function(t){var r=this.buffer.findIndex(t,1,this.bufferStart,this.index+4,this.endIndex);return r<0?null:new e(this.buffer,this.bufferStart,r,this)},e.prototype.iterate=function(t){var e=t.from,r=void 0===e?this.start:e,n=t.to,o=void 0===n?this.end:n,s=t.enter,a=t.leave,u=new i(s,a);return r<=o?this.buffer.iterChild(r,o,this.bufferStart,this.index,u):this.buffer.iterRev(r,o,this.bufferStart,this.index,this.endIndex,u),u.result},e.prototype.resolveAt=function(t){if(t<=this.start||t>=this.end)return this.parent.resolveAt(t);var r=this.buffer.findIndex(t,0,this.bufferStart,this.index+4,this.endIndex);return r<0?this:new e(this.buffer,this.bufferStart,r,this).resolveAt(t)},e.prototype.toString=function(){var t=[];return this.buffer.childToString(this.index,t),t.join("")},e}(h),y=function(){function t(t,e){this.buffer=t,this.index=e}return Object.defineProperty(t.prototype,"id",{get:function(){return this.buffer[this.index-4]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"start",{get:function(){return this.buffer[this.index-3]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this.buffer[this.index-2]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.buffer[this.index-1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pos",{get:function(){return this.index},enumerable:!0,configurable:!0}),t.prototype.next=function(){this.index-=4},t.prototype.fork=function(){return new t(this.buffer,this.index)},t}(),b=8;function m(t){var r=t,n=r.buffer,i=r.group,o=r.topID,s=void 0===o?0:o,a=r.maxBufferLength,f=void 0===a?e.DefaultBufferLength:a,h=r.reused,l=void 0===h?[]:h,p=r.minRepeatType,v=void 0===p?i.types.length:p,g=Array.isArray(n)?new y(n,n.length):n,m=i.types;function k(t,e,r,n,o){var s,a=g.id,h=g.start,p=g.end,y=g.size,T=h-t;if(y<0)return r.push(l[a]),n.push(T),void g.next();var S,N=m[a];if(p-h<=f&&(s=function(t){var e=g.fork(),r=0,n=0,i=0,o=e.end-f;t:for(var s=e.pos-t;e.pos>s;){var a=e.size,u=e.pos-a;if(a<0||u<s||e.start<o)break;var h=e.id>=v?4:0,c=e.start;for(e.next();e.pos>u;){if(e.size<0)break t;e.id>=v&&(h+=4),e.next()}n=c,r+=a,i+=h}return r>4?{size:r,start:n,skip:i}:null}(g.pos-e))){for(var P=new Uint16Array(s.size-s.skip),O=g.pos-s.size,$=P.length;g.pos>O;)$=w(s.start,P,$);S=new d(P,p-s.start,i,o),T=s.start-t}else{O=g.pos-y;g.next();var z=[],j=[],A=a>=i.types.length?a-(i.types.length-v):-1;if(A>-1)for(N=m[A];g.pos>O;){k(h,O,z,j,g.id==A?N:u.none)}else for(;g.pos>O;)k(h,O,z,j,u.none);z.reverse(),j.reverse(),S=A>-1&&z.length>b?x(N,N,z,j,0,z.length,0,f,p-h):new c(N,z,j,p-h)}r.push(S),n.push(T)}function w(t,e,r){var n=g.id,i=g.start,o=g.end,s=g.size;g.next();var a=r;if(s>4)for(var u=g.pos-(s-4);g.pos>u;)r=w(t,e,r);return n<v&&(e[--r]=a,e[--r]=o-t,e[--r]=i-t,e[--r]=n),r}for(var T=[],S=[];g.pos>0;)k(0,0,T,S,u.none);var N=T.length?S[0]+T[0].length:0;return new c(i.types[s],T.reverse(),S.reverse(),N)}function x(t,e,r,n,i,o,s,a,f){var h=[],l=[];if(f<=a)for(var p=i;p<o;p++)h.push(r[p]),l.push(n[p]-s);else{var d=Math.max(a,Math.ceil(1.5*f/b));for(p=i;p<o;){var v=p,g=n[p];for(p++;p<o;p++){if(n[p]+r[p].length-g>d)break}if(p==v+1){var y=r[v];if(y instanceof c&&y.type==e&&y.length>d<<1){for(var m=0;m<y.children.length;m++)h.push(y.children[m]),l.push(y.positions[m]+g-s);continue}h.push(y)}else if(p==v+1)h.push(r[v]);else{var w=x(e,e,r,n,v,p,g,a,n[p-1]-g);e==u.none||k(w.children,e)||(w=new c(u.none,w.children,w.positions,w.length)),h.push(w)}l.push(g-s)}}return new c(t,h,l,f)}function k(t,e){for(var r=0,n=t;r<n.length;r++){if(n[r].type==e)return!0}return!1}}));Y(Z);Z.DefaultBufferLength,Z.NodeProp,Z.NodePropSource,Z.NodeType,Z.NodeGroup,Z.Subtree,Z.Tree,Z.TreeBuffer;var tt=K((function(t,e){Object.defineProperty(e,"__esModule",{value:!0});
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};var n,i=function(){function t(t,e,r,n,i,o,s,a,u){this.cx=t,this.stack=e,this.state=r,this.reducePos=n,this.pos=i,this.recovered=o,this.buffer=s,this.bufferBase=a,this.parent=u}return t.prototype.toString=function(){return"["+this.stack.filter((function(t,e){return e%3==0})).concat(this.state)+"]@"+this.pos+(this.recovered?"!"+this.recovered:"")},t.start=function(e,r,n){return void 0===n&&(n=0),new t(e,[],r,n,n,0,[],0,null)},t.prototype.pushState=function(t,e){this.stack.push(this.state,e,this.bufferBase+this.buffer.length),this.state=t},t.prototype.reduce=function(t){var e=t>>19,r=65535&t,n=this.cx.parser;if(0==e)return r<n.minRepeatTerm&&this.storeNode(r,this.reducePos,this.reducePos,4,!0),void this.pushState(n.getGoto(this.state,r,!0),this.reducePos);var i=this.stack.length-3*(e-1)-(262144&t?6:0),o=this.stack[i-2],s=this.stack[i-1],a=this.bufferBase+this.buffer.length-s;if(r<n.minRepeatTerm||131072&t||r>n.maxNode&&r<=n.maxRepeatWrap){var u=n.stateFlag(this.state,1)?this.pos:this.reducePos;this.storeNode(r,o,u,a+4,!0)}if(262144&t)this.state=this.stack[i];else{var f=this.stack[i-3];this.state=n.getGoto(f,r,!0)}for(;this.stack.length>i;)this.stack.pop()},t.prototype.storeNode=function(t,e,r,n,i){if(void 0===n&&(n=4),void 0===i&&(i=!1),0==t){var o=this,s=this.buffer.length;if(0==s&&o.parent&&(s=o.bufferBase-o.parent.bufferBase,o=o.parent),s>0&&0==o.buffer[s-4]&&o.buffer[s-1]>-1){if(e==r)return;if(o.buffer[s-2]>=e)return void(o.buffer[s-2]=r)}}if(i&&this.pos!=r){var a=this.buffer.length;if(a>0&&0!=this.buffer[a-4])for(;a>0&&this.buffer[a-2]>r;)this.buffer[a]=this.buffer[a-4],this.buffer[a+1]=this.buffer[a-3],this.buffer[a+2]=this.buffer[a-2],this.buffer[a+3]=this.buffer[a-1],a-=4,n>4&&(n-=4);this.buffer[a]=t,this.buffer[a+1]=e,this.buffer[a+2]=r,this.buffer[a+3]=n}else this.buffer.push(t,e,r,n)},t.prototype.shift=function(t,e,r){if(131072&t)this.pushState(65535&t,this.pos);else if(0==(262144&t)){var n=this.pos,i=t,o=this.cx.parser;(r>this.pos||e<=o.maxNode)&&(this.pos=r,o.stateFlag(i,1)||(this.reducePos=r)),this.pushState(i,n),e<=o.maxNode&&this.buffer.push(e,n,r,4)}else e<=this.cx.parser.maxNode&&this.buffer.push(e,this.pos,r,4),this.pos=r},t.prototype.apply=function(t,e,r){65536&t?this.reduce(t):this.shift(t,e,r)},t.prototype.useNode=function(t,e){var r=this.cx.reused.length-1;(r<0||this.cx.reused[r]!=t)&&(this.cx.reused.push(t),r++);var n=this.pos;this.reducePos=this.pos=n+t.length,this.pushState(e,n),this.buffer.push(r,n,this.reducePos,-1)},t.prototype.split=function(){for(var e=this,r=e.buffer.length;r>0&&e.buffer[r-2]>e.reducePos;)r-=4;for(var n=e.buffer.slice(r),i=e.bufferBase+r;e&&i==e.bufferBase;)e=e.parent;return new t(this.cx,this.stack.slice(),this.state,this.reducePos,this.pos,this.recovered,n,i,e)},t.prototype.recoverByDelete=function(t,e){var r=t<=this.cx.parser.maxNode;r&&this.storeNode(t,this.pos,e),this.storeNode(0,this.pos,e,r?8:4),this.pos=this.reducePos=e,this.recovered+=2},t.prototype.canShift=function(t){for(var e=new o(this);;){var r=this.cx.parser.stateSlot(e.top,4)||this.cx.parser.hasAction(e.top,t);if(0==(65536&r))return!0;if(0==r)return!1;e.reduce(r)}},Object.defineProperty(t.prototype,"ruleStart",{get:function(){var t=this.cx.parser.stateSlot(this.state,5);if(!(65536&t))return 0;var e=this.stack.length-3*(t>>19);return this.stack[e+1]},enumerable:!0,configurable:!0}),t.prototype.startOf=function(t){for(var e=this.stack.length;e>=0;e-=3){var r=e==this.stack.length?this.state:this.stack[e],n=this.cx.parser.stateSlot(r,5);if(t.includes(65535&n)){var i=e-3*(n>>19);return this.stack[i+1]}}return-1},t.prototype.recoverByInsert=function(t){var e=this,r=this.cx.parser.nextStates(this.state);if(r.length>4){for(var n=r.filter((function(r){return r!=e.state&&e.cx.parser.hasAction(r,t)})),i=0;n.length<4&&i<r.length;i++)n.includes(r[i])||n.push(r[i]);r=n}var o=[];for(i=0;i<r.length&&o.length<4;i++)if(r[i]!=this.state){var s=this.split();s.storeNode(0,s.pos,s.pos,4,!0),s.pushState(r[i],this.pos),s.recovered+=2,o.push(s)}return o},t.prototype.forceReduce=function(){var t=this.cx.parser.stateSlot(this.state,5);return 0!=(65536&t)&&(this.cx.parser.validAction(this.state,t)||(this.storeNode(0,this.reducePos,this.reducePos,4,!0),this.recovered+=1),this.reduce(t),!0)},t.prototype.forceAll=function(){for(;!this.cx.parser.stateFlag(this.state,2)&&this.forceReduce(););return this},t.prototype.toTree=function(){return Z.Tree.build({buffer:s.create(this),group:this.cx.parser.group,topID:this.cx.topTerm,maxBufferLength:this.cx.maxBufferLength,reused:this.cx.reused,minRepeatType:this.cx.parser.minRepeatTerm})},t}();!function(t){t[t.Token=2]="Token",t[t.Reduce=1]="Reduce",t[t.MaxNext=4]="MaxNext"}(n||(n={}));var o=function(){function t(t){this.stack=t,this.top=t.state,this.rest=t.stack,this.offset=this.rest.length}return t.prototype.reduce=function(t){var e=65535&t,r=t>>19;0==r?(this.rest==this.stack.stack&&(this.rest=this.rest.slice()),this.rest.push(this.top,0,0),this.offset+=3):this.offset-=3*(r-1);var n=this.stack.cx.parser.getGoto(this.rest[this.offset-3],e,!0);this.top=n},t}(),s=function(){function t(t,e,r){this.stack=t,this.pos=e,this.index=r,this.buffer=t.buffer,0==this.index&&this.maybeNext()}return t.create=function(e){return new t(e,e.bufferBase+e.buffer.length,e.buffer.length)},t.prototype.maybeNext=function(){var t=this.stack.parent;null!=t&&(this.index=this.stack.bufferBase-t.bufferBase,this.stack=t,this.buffer=t.buffer)},Object.defineProperty(t.prototype,"id",{get:function(){return this.buffer[this.index-4]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"start",{get:function(){return this.buffer[this.index-3]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this.buffer[this.index-2]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.buffer[this.index-1]},enumerable:!0,configurable:!0}),t.prototype.next=function(){this.index-=4,this.pos-=4,0==this.index&&this.maybeNext()},t.prototype.fork=function(){return new t(this.stack,this.pos,this.index)},t}(),a=function(){function t(){this.start=-1,this.value=-1,this.end=-1}return t.prototype.accept=function(t,e){this.value=t,this.end=e},t}(),u=function(){function t(t,e){void 0===e&&(e=t.length),this.string=t,this.length=e}return t.prototype.get=function(t){return t<0||t>=this.length?-1:this.string.charCodeAt(t)},t.prototype.read=function(t,e){return this.string.slice(t,Math.min(this.length,e))},t.prototype.clip=function(e){return new t(this.string,e)},t}(),f=function(){function t(t,e){this.data=t,this.id=e}return t.prototype.token=function(t,e,r){!function(t,e,r,n,i){var o=0,s=1<<i;t:for(var a=r.start;0!=(s&t[o]);){for(var u=t[o+1],f=o+3;f<u;f+=2)if((t[f+1]&s)>0){var h=t[f];if(-1==r.value||r.value==h||n.cx.parser.overrides(h,r.value)){r.accept(h,a);break}}for(var c=e.get(a++),l=0,p=t[o+2];l<p;){var d=l+p>>1,v=u+d+(d<<1),g=t[v],y=t[v+1];if(c<g)p=d;else{if(!(c>=y)){o=t[v+2];continue t}l=d+1}}break}}(this.data,t,e,r,this.id)},t}();f.prototype.contextual=!1;var h=function(t,e){void 0===e&&(e={}),this.token=t,this.contextual=e&&e.contextual||!1};function c(t,e){void 0===e&&(e=Uint16Array);for(var r=null,n=0,i=0;n<t.length;){for(var o=0;;){var s=t.charCodeAt(n++),a=!1;if(126==s){o=65535;break}s>=92&&s--,s>=34&&s--;var u=s-32;if(u>=46&&(u-=46,a=!0),o+=u,a)break;o*=46}r?r[i++]=o:r=new e(o)}return r}var l="undefined"!=typeof process&&/\bparse\b/.test(process.env.LOG),p=function(){function t(t){this.start=[0],this.index=[0],this.nextStart=0,this.trees=[t]}return t.prototype.nodeAt=function(t){if(t<this.nextStart)return null;for(;;){var e=this.trees.length-1;if(e<0)return this.nextStart=1e9,null;var r=this.trees[e],n=this.index[e];if(n!=r.children.length){var i=r.children[n],o=this.start[e]+r.positions[n];if(o>=t)return o==t?i:null;i instanceof Z.TreeBuffer?(this.index[e]++,this.nextStart=o+i.length):(this.index[e]++,o+i.length>=t&&(this.trees.push(i),this.start.push(o),this.index.push(0)))}else this.trees.pop(),this.start.pop(),this.index.pop()}},t}(),d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.extended=-1,e.mask=0,e}return function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}(e,t),e.prototype.clear=function(t){this.start=t,this.value=this.extended=-1},e}(a),v=new a,g=function(){function t(t){this.tokens=[],this.mainToken=v,this.actions=[],this.tokens=t.tokenizers.map((function(t){return new d}))}return t.prototype.getActions=function(t,e){for(var r=0,n=null,i=t.cx.parser,o=i.tokenizers,s=i.stateSlot(t.state,3),a=0;a<o.length;a++)if(0!=(1<<a&s)){var u=o[a],f=this.tokens[a];(u.contextual||f.start!=t.pos||f.mask!=s)&&(this.updateCachedToken(f,u,t,e),f.mask=s);var h=r;if(f.extended>-1&&(r=this.addActions(t,f.extended,f.end,r)),(r=this.addActions(t,f.value,f.end,r))>h){n=f;break}n&&0==f.value||(n=f)}for(;this.actions.length>r;)this.actions.pop();return n||((n=v).start=t.pos,t.pos==e.length?n.accept(t.cx.parser.eofTerm,t.pos):n.accept(0,t.pos+1)),this.mainToken=n,this.actions},t.prototype.updateCachedToken=function(t,e,r,n){if(t.clear(r.pos),e.token(n,t,r),t.value>-1){var i=r.cx.parser,o=k(i.data,i.specializeTable,t.value);if(o>=0){var s=i.specializations[o][n.read(t.start,t.end)];null!=s&&(0==(1&s)?t.value=s>>1:t.extended=s>>1)}}else r.pos==n.length?t.accept(r.cx.parser.eofTerm,r.pos):t.accept(0,r.pos+1)},t.prototype.putAction=function(t,e,r,n){for(var i=0;i<n;i+=3)if(this.actions[i]==t)return n;return this.actions[n++]=t,this.actions[n++]=e,this.actions[n++]=r,n},t.prototype.addActions=function(t,e,r,n){for(var i=t.state,o=t.cx.parser,s=o.data,a=0;a<2;a++)for(var u=o.stateSlot(i,a?2:1),f=void 0;65535!=(f=s[u]);u+=3)(f==e||0==f&&0==n)&&(n=this.putAction(s[u+1]|s[u+2]<<16,e,r,n));return n},t}(),y=function(t,e,r,n,i,o){void 0===i&&(i=null),void 0===o&&(o=-1),this.parser=t,this.maxBufferLength=e,this.input=r,this.topTerm=n,this.parent=i,this.wrapType=o,this.reused=[],this.tokens=new g(t)},b=function(){function t(t,e,r){var n=void 0===r?{}:r,o=n.cache,s=void 0===o?void 0:o,a=n.strict,u=void 0!==a&&a,f=n.bufferLength,h=void 0===f?Z.DefaultBufferLength:f,c=n.top,l=void 0===c?void 0:c;this.pos=0,this.recovering=0,this.tokenCount=0;var d=t.topRules[l||Object.keys(t.topRules)[0]];if(!d)throw new RangeError("Invalid top rule name "+l);this.stacks=[i.start(new y(t,h,e,d[1]),d[0])],this.strict=u,this.cache=s?new p(s):null}return t.prototype.putStack=function(t){this.stacks.push(t),(this.pos<0||t.pos<this.pos)&&(this.pos=t.pos)},t.prototype.advance=function(){var t=this.stacks,e=this.pos;this.stacks=[],this.pos=-1;for(var r=null,n=null,i=0;i<t.length;i++)for(var o=t[i];;){if(o.pos>e)this.putStack(o);else{var s=this.advanceStack(o,t);if(s){o=s;continue}r||(r=[],n=[]),r.push(o);var a=o.cx.tokens.mainToken;n.push(a.value,a.end)}break}if(!this.stacks.length){var u;if(u=r&&function(t){for(var e=null,r=0,n=t;r<n.length;r++){var i=n[r];i.pos==i.cx.input.length&&i.cx.parser.stateFlag(i.state,2)&&(!e||e.recovered>i.recovered)&&(e=i)}return e}(r))return u.toTree();if(this.strict)throw new SyntaxError("No parse at "+e);this.recovering||(this.recovering=5)}if(this.recovering&&r&&(u=this.runRecovery(r,n)))return u.forceAll().toTree();if(this.recovering){var f=1==this.recovering?1:3*this.recovering;this.stacks.length>f&&(this.stacks.sort((function(t,e){return t.recovered-e.recovered})),this.stacks.length=f),this.stacks.some((function(t){return t.reducePos>e}))&&this.recovering--}else if(this.stacks.length>1&&this.stacks[0].buffer.length>200){var h=1e9,c=-1;for(i=0;i<this.stacks.length;i++){(o=this.stacks[i]).buffer.length<h&&(h=o.buffer.length,c=i)}h>200&&this.stacks.splice(c,1)}return this.tokenCount++,null},t.prototype.advanceStack=function(t,e){var r=t.pos,n=t.cx,o=n.input,s=n.parser,a=l?t+" -> ":"";if(this.cache)for(var u=this.cache.nodeAt(r);u;){var f=s.group.types[u.type.id]==u.type?s.getGoto(t.state,u.type.id):-1;if(f>-1)return t.useNode(u,f),l&&console.log(a+t+" (via reuse of "+s.getName(u.type.id)+")"),t;if(!(u instanceof Z.Tree)||0==u.children.length||u.positions[0]>0)break;var h=u.children[0];if(!(h instanceof Z.Tree))break;u=h}var c=s.startNested(t.state);t:if(c>-1){var p=s.nested[c],d=p.grammar,v=p.end,g=p.placeholder,b=void 0,m=null,x=void 0,k=void 0,w=void 0;if("function"==typeof d){var T=d(o,t);if(T.stay)break t;m=T.parseNode,x=T.parser,k=T.top,b=T.filterEnd,w=T.wrapType}else x=d;var S=this.scanForNestEnd(t,v,b),N=t.cx.input.clip(S);if(m||!x){var P=m?m(N,t.pos):Z.Tree.empty;return P.length!=S-t.pos&&(P=new Z.Tree(P.type,P.children,P.positions,S-t.pos)),null!=w&&(P=new Z.Tree(s.group.types[w],[P],[0],P.length)),t.useNode(P,s.getGoto(t.state,g,!0)),t}var O=x.topRules[k||Object.keys(x.topRules)[0]],$=i.start(new y(x,t.cx.maxBufferLength,N,O[1],t,w),O[0],t.pos);return l&&console.log(a+$+" (nested)"),$}var z=s.stateSlot(t.state,4);if(z>0)return t.reduce(z),l&&console.log(a+t+" (via always-reduce "+s.getName(65535&z)+")"),t;for(var j=t.cx.tokens.getActions(t,o),A=0;A<j.length;){var _=j[A++],C=j[A++],B=(S=j[A++],A==j.length||!e),I=B?t:t.split();if(I.apply(_,C,S),l&&console.log(a+I+" (via "+(0==(65536&_)?"shift":"reduce of "+s.getName(65535&_))+" for "+s.getName(C)+" @ "+r+(I==t?"":", split")+")"),B)return I;I.pos>r?this.putStack(I):e.push(I)}return t.cx.parent&&t.pos==o.length?function(t){if(-2==t.cx.wrapType)return null;var e=t.cx.parent,r=t.forceAll().toTree(),n=e.cx.parser,i=n.nested[n.startNested(e.state)];r=new Z.Tree(r.type,r.children,r.positions.map((function(t){return t-e.pos})),t.pos-e.pos),t.cx.wrapType>-1&&(r=new Z.Tree(n.group.types[t.cx.wrapType],[r],[0],r.length));t.cx.wrapType=-2,e.useNode(r,n.getGoto(e.state,i.placeholder,!0)),l&&console.log(e+" (via unnest "+(t.cx.wrapType>-1?n.getName(t.cx.wrapType):r.type.name)+")");return e}(t):null},t.prototype.advanceFully=function(t){for(var e=t.pos;;){var r=this.advanceStack(t,null);if(!r)return t;if(r.pos>e)return this.putStack(r),null;t=r}},t.prototype.runRecovery=function(t,e){for(var r=null,n=0;n<t.length;n++){for(var i=t[n],o=e[n<<1],s=e[1+(n<<1)],a=l?i+" -> ":"",u=i.split(),f=a,h=0;u.forceReduce()&&h<10;h++){l&&console.log(f+u+" (via force-reduce)");var c=this.advanceFully(u);if(!c)break;u=c,l&&(f=c+" -> ")}for(var p=0,d=i.recoverByInsert(o);p<d.length;p++){var v=d[p];l&&console.log(a+v+" (via recover-insert)"),this.advanceFully(v)}i.cx.input.length>i.pos?(s==i.pos&&(s++,o=0),i.recoverByDelete(o,s),l&&console.log(a+i+" (via recover-delete "+i.cx.parser.getName(o)+")"),this.putStack(i)):i.cx.parent||r&&!(r.recovered>i.recovered)||(r=i)}return r},t.prototype.forceFinish=function(){return this.stacks[0].split().forceAll().toTree()},Object.defineProperty(t.prototype,"badness",{get:function(){return 2*this.stacks[0].recovered/this.tokenCount},enumerable:!0,configurable:!0}),t.prototype.scanForNestEnd=function(t,e,r){for(var n=t.cx.input,i=t.pos;i<n.length;i++)if(v.start=i,v.value=-1,e.token(n,v,t),v.value>-1&&(!r||r(n.read(i,v.end))))return i;return n.length},t}(),m=function(){function t(t,e,r,n,i,o,s,a,u,f,h,c){void 0===c&&(c=null),this.states=t,this.data=e,this.goto=r,this.group=n,this.minRepeatTerm=i,this.tokenizers=o,this.topRules=s,this.nested=a,this.specializeTable=u,this.specializations=f,this.tokenPrecTable=h,this.termNames=c,this.nextStateCache=[],this.maxNode=this.group.types.length-1,this.maxRepeatWrap=this.group.types.length+(this.group.types.length-i)-1;for(var l=0,p=this.states.length/6;l<p;l++)this.nextStateCache[l]=null}return t.prototype.parse=function(t,e){"string"==typeof t&&(t=new u(t));for(var r=new b(this,t,e);;){var n=r.advance();if(n)return n}},t.prototype.startParse=function(t,e){return"string"==typeof t&&(t=new u(t)),new b(this,t,e)},t.prototype.getGoto=function(t,e,r){void 0===r&&(r=!1);var n=this.goto;if(e>=n[0])return-1;for(var i=n[e+1];;){var o=n[i++],s=1&o,a=n[i++];if(s&&r)return a;for(var u=i+(o>>1);i<u;i++)if(n[i]==t)return a;if(s)return-1}},t.prototype.hasAction=function(t,e){for(var r=this.data,n=0;n<2;n++)for(var i=this.stateSlot(t,n?2:1),o=void 0;65535!=(o=r[i]);i+=3)if(o==e||0==o)return r[i+1]|r[i+2]<<16;return 0},t.prototype.stateSlot=function(t,e){return this.states[6*t+e]},t.prototype.stateFlag=function(t,e){return(this.stateSlot(t,0)&e)>0},t.prototype.startNested=function(t){var e=this.stateSlot(t,0);return 4&e?e>>10:-1},t.prototype.validAction=function(t,e){if(e==this.stateSlot(t,4))return!0;for(var r=this.stateSlot(t,1);;r+=3){if(65535==this.data[r])return!1;if(e==(this.data[r+1]|this.data[r+2]<<16))return!0}},t.prototype.nextStates=function(t){var e=this.nextStateCache[t];if(e)return e;for(var r=[],n=this.stateSlot(t,1);65535!=this.data[n];n+=3)0!=(1&this.data[n+2])||r.includes(this.data[n+1])||r.push(this.data[n+1]);for(var i=this.goto,o=i[0],s=0;s<o;s++)for(var a=i[s+1];;){for(var u=i[a++],f=i[a++],h=a+(u>>1);a<h;a++)i[a]!=t||r.includes(f)||r.push(f);if(1&u)break}return this.nextStateCache[t]=r},t.prototype.overrides=function(t,e){var r=k(this.data,this.tokenPrecTable,e);return r<0||k(this.data,this.tokenPrecTable,t)<r},t.prototype.withNested=function(e){return new t(this.states,this.data,this.goto,this.group,this.minRepeatTerm,this.tokenizers,this.topRules,this.nested.map((function(t){return Object.prototype.hasOwnProperty.call(e,t.name)?{name:t.name,grammar:e[t.name],end:t.end,placeholder:t.placeholder}:t})),this.specializeTable,this.specializations,this.tokenPrecTable,this.termNames)},t.prototype.withProps=function(){for(var e,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return new t(this.states,this.data,this.goto,(e=this.group).extend.apply(e,r),this.minRepeatTerm,this.tokenizers,this.topRules,this.nested,this.specializeTable,this.specializations,this.tokenPrecTable,this.termNames)},t.prototype.getName=function(t){return this.termNames?this.termNames[t]:String(t<=this.maxNode&&this.group.types[t].name||t)},Object.defineProperty(t.prototype,"eofTerm",{get:function(){return this.maxRepeatWrap+1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasNested",{get:function(){return this.nested.length>0},enumerable:!0,configurable:!0}),t.deserialize=function(e){for(var r=c(e.tokenData),n=e.nodeNames.split(" "),i=n.length,o=0;o<e.repeatNodeCount;o++)n.push("");var s=[];for(o=0;o<n.length;o++)s.push(x);function a(t,e,r){s[t]==x&&(s[t]=Object.create(null)),e.set(s[t],e.deserialize(r))}if(a(0,Z.NodeProp.error,""),e.nodeProps)for(var u=0,h=e.nodeProps;u<h.length;u++){var l=h[u],p=l[0];for(o=1;o<l.length;o+=2)a(l[o],p,l[o+1])}var d=new Z.NodeGroup(n.map((function(t,e){return new Z.NodeType(t,s[e],e)})));return new t(c(e.states,Uint32Array),c(e.stateData),c(e.goto),d,i,e.tokenizers.map((function(t){return"number"==typeof t?new f(r,t):t})),e.topRules,(e.nested||[]).map((function(t){var e=t[0],r=t[1],n=t[2],i=t[3];return{name:e,grammar:r,end:new f(c(n),0),placeholder:i}})),e.specializeTable,(e.specializations||[]).map(w),e.tokenPrec,e.termNames)},t}(),x=Object.create(null);function k(t,e,r){for(var n=e,i=void 0;65535!=(i=t[n]);n++)if(i==r)return n-e;return-1}function w(t){if(!(t instanceof Object))return t;var e=Object.create(null);for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}e.NodeGroup=Z.NodeGroup,e.NodeProp=Z.NodeProp,e.NodeType=Z.NodeType,e.Subtree=Z.Subtree,e.Tree=Z.Tree,e.ExternalTokenizer=h,e.ParseContext=b,e.Parser=m,e.Stack=i,e.Token=a,e.TokenGroup=f}));Y(tt);tt.NodeGroup;var et=tt.NodeProp;tt.NodeType,tt.Subtree,tt.Tree,tt.ExternalTokenizer,tt.ParseContext,tt.Parser,tt.Stack,tt.Token,tt.TokenGroup;function rt(t){let e,r,n="unaryTest"===t[4]&&it();return{c(){e=h("Enter JSON object literal.\n              "),n&&n.c(),r=h("")},m(t,i){a(t,e,i),n&&n.m(t,i),a(t,r,i)},p(t,e){"unaryTest"===t[4]?n||(n=it(),n.c(),n.m(r.parentNode,r)):n&&(n.d(1),n=null)},d(t){t&&u(e),n&&n.d(t),t&&u(r)}}}function nt(e){let r;return{c(){r=h("Failed to parse as JSON.")},m(t,e){a(t,r,e)},p:t,d(t){t&&u(r)}}}function it(t){let e,r,n;return{c(){e=h("Input named "),r=f("code"),r.textContent="?",n=h(" is treated as value to test."),p(r,"class","svelte-1a2sz7n")},m(t,i){a(t,e,i),a(t,r,i),a(t,n,i)},d(t){t&&u(e),t&&u(r),t&&u(n)}}}function ot(e){let r;return{c(){r=h("Change code or input to re-compute output.")},m(t,e){a(t,r,e)},p:t,d(t){t&&u(r)}}}function st(t){let e,r,n=t[8].message+"";return{c(){e=h("Evaluation failed: "),r=h(n)},m(t,n){a(t,e,n),a(t,r,n)},p(t,e){256&e[0]&&n!==(n=t[8].message+"")&&d(r,n)},d(t){t&&u(e),t&&u(r)}}}function at(t){let e,r,i,o,m,x,k,w,T,S,N,P,O,z,j,A,_,C,B,M,D,G,U,H,J,W,V,Q,X,Y,K,Z,tt,et,it,at,ut,ft,ht,ct,lt,pt,dt,vt=(void 0!==t[7]&&JSON.stringify(t[7],0,2)||"")+"";function gt(t,e){return t[10]?nt:rt}let yt=gt(t),bt=yt(t);function mt(t,e){return t[8]?st:ot}let xt=mt(t),kt=xt(t);const wt=new q({props:{node:t[2],selection:t[3],onSelect:t[11]}});return{c(){e=f("main"),r=f("header"),r.innerHTML='<a href="/" class="logo svelte-1a2sz7n"><img alt="F" src="logo.svg" class="svelte-1a2sz7n"></a> \n\n    <span style="\n        font-weight: bold;\n        font-size: 1.2em;\n        color: steelblue;\n        margin-left: 2px;\n    "><span aria-hidden="false" style="\n        display: none;\n    ">F</span>eel Playground</span> \n\n    <div class="menu svelte-1a2sz7n"><a href="https://github.com/nikku/feel-playground/issues">Report an Issue</a> ·\n      <a href="https://github.com/nikku/feel-playground">View on GitHub</a></div>',i=c(),o=f("div"),m=f("div"),x=f("div"),k=f("h3"),w=h("Code "),T=f("select"),S=f("option"),S.textContent="Expression",N=f("option"),N.textContent="Unary Test",P=c(),O=f("span"),z=f("label"),j=f("input"),A=h(" Syntax highlight"),_=c(),C=f("div"),B=f("textarea"),M=c(),D=f("div"),G=f("div"),U=f("h3"),U.textContent="Input",H=c(),J=f("div"),W=f("textarea"),V=c(),Q=f("div"),bt.c(),X=c(),Y=f("div"),K=f("h3"),K.textContent="Output",Z=c(),tt=f("div"),et=h(vt),it=c(),at=f("div"),kt.c(),ut=c(),ft=f("div"),ht=f("h3"),ht.textContent="Tree",ct=c(),lt=f("div"),E(wt.$$.fragment),p(r,"class","hcontainer svelte-1a2sz7n"),S.__value="expression",S.value=S.__value,N.__value="unaryTest",N.value=N.__value,p(T,"class","typeselect svelte-1a2sz7n"),p(T,"name","feelType"),void 0===t[4]&&$(()=>t[26].call(T)),p(j,"type","checkbox"),p(z,"class","svelte-1a2sz7n"),p(O,"class","right svelte-1a2sz7n"),p(k,"class","legend svelte-1a2sz7n"),p(B,"name","expression"),p(C,"class","content svelte-1a2sz7n"),b(C,"highlight-container",t[5]),p(x,"class","container code-editor svelte-1a2sz7n"),p(U,"class","legend svelte-1a2sz7n"),p(W,"name","contextString"),p(J,"class","content svelte-1a2sz7n"),p(Q,"class","note svelte-1a2sz7n"),b(Q,"error-note",t[10]),p(G,"class","container context-editor svelte-1a2sz7n"),p(K,"class","legend svelte-1a2sz7n"),p(tt,"class","content svelte-1a2sz7n"),p(at,"class","note svelte-1a2sz7n"),b(at,"error-note",t[8]),p(Y,"class","container output svelte-1a2sz7n"),p(D,"class","hcontainer svelte-1a2sz7n"),p(m,"class","vcontainer svelte-1a2sz7n"),g(m,"flex",".6"),p(ht,"class","legend svelte-1a2sz7n"),p(lt,"class","content svelte-1a2sz7n"),p(ft,"class","container tree svelte-1a2sz7n"),g(ft,"flex",".4"),p(o,"class","views hcontainer svelte-1a2sz7n"),p(e,"class","vcontainer svelte-1a2sz7n"),dt=[l(T,"change",t[26]),l(j,"change",t[27]),l(B,"input",t[29]),l(C,"mousemove",t[12]),l(W,"input",t[31])]},m(n,u){a(n,e,u),s(e,r),s(e,i),s(e,o),s(o,m),s(m,x),s(x,k),s(k,w),s(k,T),s(T,S),s(T,N),y(T,t[4]),s(k,P),s(k,O),s(O,z),s(z,j),j.checked=t[5],s(z,A),s(x,_),s(x,C),s(C,B),t[28](B),v(B,t[6]),s(m,M),s(m,D),s(D,G),s(G,U),s(G,H),s(G,J),s(J,W),t[30](W),v(W,t[9]),s(G,V),s(G,Q),bt.m(Q,null),s(D,X),s(D,Y),s(Y,K),s(Y,Z),s(Y,tt),s(tt,et),s(Y,it),s(Y,at),kt.m(at,null),s(o,ut),s(o,ft),s(ft,ht),s(ft,ct),s(ft,lt),L(wt,lt,null),pt=!0},p(t,e){16&e[0]&&y(T,t[4]),32&e[0]&&(j.checked=t[5]),64&e[0]&&v(B,t[6]),32&e[0]&&b(C,"highlight-container",t[5]),512&e[0]&&v(W,t[9]),yt===(yt=gt(t))&&bt?bt.p(t,e):(bt.d(1),bt=yt(t),bt&&(bt.c(),bt.m(Q,null))),1024&e[0]&&b(Q,"error-note",t[10]),(!pt||128&e[0])&&vt!==(vt=(void 0!==t[7]&&JSON.stringify(t[7],0,2)||"")+"")&&d(et,vt),xt===(xt=mt(t))&&kt?kt.p(t,e):(kt.d(1),kt=xt(t),kt&&(kt.c(),kt.m(at,null))),256&e[0]&&b(at,"error-note",t[8]);const r={};4&e[0]&&(r.node=t[2]),8&e[0]&&(r.selection=t[3]),wt.$set(r)},i(t){pt||(I(wt.$$.fragment,t),pt=!0)},o(t){R(wt.$$.fragment,t),pt=!1},d(r){r&&u(e),t[28](null),t[30](null),bt.d(),kt.d(),F(wt),n(dt)}}}function ut(t,e,r){const n=t.getDoc();let i=e.start,o=e.end,s="";i===o&&(i>0?(i--,s="-after"):(o++,s="-before"));const a=n.posFromIndex(i),u=n.posFromIndex(o);return t.markText(a,u,{className:`mark-${r}${s}`})}function ft(t){t.clear()}function ht(t){const{name:e,error:r}=t;return r?"error":"BuiltInFunctionName"===e?"builtin":"BuiltInType"===e||"ListType"===e||"ContextType"===e||"FunctionType"===e?"builtin":"BlockComment"===e||"LineComment"===e?"comment":"Parameters"===e?"parameters":"List"===e?"list":"Context"===e?"context":"Interval"===e?"interval":"StringLiteral"===e?"string":"NumericLiteral"===e?"number":"BooleanLiteral"===e?"boolean":"QualifiedName"===e?"qname":"Name"===e?"name":void 0}function ct(t,e,r){const n=function(){const t=window.location.hash,[e,r,n,i]=t.slice(1).split(";").map(decodeURIComponent);return{expression:e,contextString:r,syntaxHighlight:n,feelType:i}}();let i,o,s,a,u,f,h,c,l={name:"Expression",start:0,end:0,children:[]},p=[],d=n.feelType||"expression",v=[],g="false"!==n.syntaxHighlight,y=n.expression||'for\n  fruit in [ "apple", "bananas" ], vegetable in vegetables\nreturn\n  { ingredients: [ fruit, vegetable ] }',b=void 0,m=null,x=n.contextString||'{\n  "vegetables": [ "garlic", "tomato" ],\n  "Mike\'s age": 35\n}';var w;function S(t,e){console.time("renderSyntax"),v.forEach(ft),t&&(v=e.reduce((e,r)=>(e.push(ut(t,r,r.tokenType)),e),[])),console.timeEnd("renderSyntax")}function N(t,e){console.time("renderSelection"),f&&ft(f),e&&t&&(f=ut(t,e,"selection")),console.timeEnd("renderSelection")}w=()=>{r(13,s=CodeMirror.fromTextArea(i,{lineNumbers:!0,mode:null})),s.on("change",()=>{r(6,y=s.getDoc().getValue())}),a=CodeMirror.fromTextArea(o,{mode:{name:"javascript",json:!0},theme:"default"}),a.on("change",()=>{r(9,x=a.getDoc().getValue())})},k().$$.on_mount.push(w);const P=Q((function(t,e,n,i){console.time("updateStack");const o=[{children:[]}],s=[],a="unaryTest"===t?Feelin.parseUnaryTests:Feelin.parseExpressions,{tree:u,parsedInput:f}=a(e,n);u.iterate({enter(t,e,r){const{name:n}=t,i=n===f.slice(e,r),s={name:n,start:e,end:r,children:[],error:t.prop(et.error),skip:i};o.push({...s,tokenType:ht(s)})},leave(t,e,r){const n=o.pop();n.skip||(o[o.length-1].children.push(n),(i&&n.tokenType||n.error)&&s.push(n))}}),r(2,l=o[0].children[0]),r(15,p=s),console.timeEnd("updateStack")}),300),O=Q((function(t){try{if(r(18,h=JSON.parse(t||{})),"object"!=typeof h)throw r(18,h={}),new Error("expected Object literal");r(10,c=null)}catch(t){r(10,c=t)}}),300),$=Q((function(t,e,n){const i="unaryTest"===t?Feelin.unaryTest:Feelin.evaluate;try{r(7,b=i(e,n)),r(8,m=null)}catch(t){console.error(t),r(7,b=void 0),r(8,m=t)}}),300);return t.$$.update=()=>{512&t.$$.dirty[0]&&O(x),262256&t.$$.dirty[0]&&void 0!==y&&P(d,y,h,g),262224&t.$$.dirty[0]&&$(d,y,h),8200&t.$$.dirty[0]&&N(s,u),40960&t.$$.dirty[0]&&S(s,p),624&t.$$.dirty[0]&&function(t,e,r,n){window.location.hash="#"+[t,e,r,n].map(encodeURIComponent).join(";")}(y,x,g,d)},[i,o,l,u,d,g,y,b,m,x,c,function(t){r(3,u=t)},function(t){const e=s.coordsChar({left:t.clientX,top:t.clientY},"window"),n=function(t,e){if(t>=e.end||t<=e.start)return null;let r=e;t:for(;;){for(const e of r.children)if(e.start<=t&&e.end>t){if(!e.children.length)return e;r=e;continue t}return r}}(s.getDoc().indexFromPos(e),l);n!==u&&r(3,u=n)},s,a,p,v,f,h,n,void 0,S,N,P,O,$,function(){d=function(t){const e=t.querySelector(":checked")||t.options[0];return e&&e.__value}(this),r(4,d)},function(){g=this.checked,r(5,g)},function(t){T[t?"unshift":"push"](()=>{r(0,i=t)})},function(){y=this.value,r(6,y)},function(t){T[t?"unshift":"push"](()=>{r(1,o=t)})},function(){x=this.value,r(9,x)}]}return new class extends G{constructor(t){super(),D(this,t,ct,at,o,{},[-1,-1])}}({target:document.body})}();
